# 📂 VBA Evidence Tool

## 📋 概要
**VBA Evidence Tool**は、ファイル管理および画像挿入機能を含む高機能なExcelツールです。  
特定のフォルダやサブフォルダを検索し、有効な画像ファイルを見つけて、Excelシートに適切なサイズで挿入します。  
また、複数のシートを統合・削除して効率的にデータを管理します。

---

## 📦 主な機能
1. **シート削除 (`DeleteSheet`)**
   - 既存のシートを確認し、特定のシートを削除して初期化します。

2. **シート抽出 (`ExportWorkSheets`)**
   - 現在のExcelファイルから特定のシートを抽出し、新しいファイルとして保存します。
   - 保存されたファイルには基本的なフォーマットと設定が適用されます。

3. **フォルダおよびファイル検索 (`FList_MST`, `Folder_List`, `File_List`)**
   - 選択したフォルダとサブフォルダを再帰的に検索し、ファイルリストを収集します。

4. **画像編集および挿入 (`EditPicture`)**
   - 有効な画像ファイル（JPG、PNGなど）をExcelシートに挿入します。
   - 画像のサイズや解像度に基づいてセルの範囲を動的に調整します。

5. **シート重複確認 (`SearchSameNameSheet`)**
   - 同じ名前のシートが存在するか確認し、必要に応じて新しいシートを作成するか、既存のシートを上書きします。

6. **ファイルエクスプローラーを開く (`OpenExplorer`)**
   - 完了したフォルダをWindowsのファイルエクスプローラーで開き、作業結果を確認します。

7. **警告メッセージ表示 (`AlertMessage`)**
   - 無効なファイル形式やその他のエラー状況に対する警告メッセージを提供します。

---

## 🛠️ 使用方法
1. **Excelマクロ設定**
   - ExcelでVBAエディタを開き（`Alt + F11`）、コードウィンドウに提供されたVBAコードを貼り付けます。
   - **"Microsoft Scripting Runtime"** および **"Microsoft Scripting Library"** ライブラリを参照設定に追加します。

   - 設定手順：
     1. VBAエディタのメニューバーで **[ツール]** をクリックします。
     2. **[参照設定]** を選択します。
     3. **"Microsoft Scripting Runtime"** および **"Microsoft Scripting Library"** オプションをチェックします。

2. **フォルダ選択**
   - マクロを実行するとフォルダ選択ダイアログが開きます。処理するフォルダを選択してください。

3. **ファイルおよび画像の操作**
   - 選択したフォルダ内の有効な画像ファイルが検索され、指定されたルールに基づいてExcelシートに挿入されます。

4. **シート操作**
   - 不要なシートを削除するか、特定のシートを抽出して新しいファイルに保存できます。

---

## 📂 コード説明
### 主な関数およびサブルーチン
1. **`DeleteSheet()`**
   - "Tool" シートを除くすべてのシートを削除します。
   - 削除前に確認メッセージが表示されます。

2. **`ExportWorkSheets()`**
   - 現在のブックから特定のシートを抽出し、別のファイルとして保存します。
   - 保存されたファイルは自動的に開きます。

3. **`FList_MST()` および `Folder_List()`**
   - フォルダおよびサブフォルダを再帰的に検索し、ファイルリストを収集します。

4. **`File_List()`**
   - 各ファイルの形式を確認し、適切なファイルのみ処理します。

5. **`EditPicture()`**
   - 画像ファイルをExcelシートに挿入し、そのサイズを調整します。

6. **`SearchSameNameSheet()`**
   - 同じ名前のシートが存在する場合、削除後に新しいシートを作成するか、既存のシートを維持します。

7. **`AlertMessage()`**
   - 無効なファイルやエラー状況に対する警告をユーザーに通知します。

---

## 📮 注意事項
1. **フォルダおよびファイルの有効性確認**
   - JPGまたはPNG形式の画像ファイルのみ挿入されます。
   - 隠しファイル、システムファイルなどは処理されません。

2. **シート操作**
   - 作業前に重要なデータをバックアップしてください。シートを削除すると復元できません。

3. **Excelマクロ環境設定**
   - fileSystemObjectを使用しています。マクロを実行する前に、VBAエディタで以下の設定を行ってください：
     1. VBAエディタを開き（`Alt + F11`）、**[ツール]** メニューをクリックします。
     2. **[参照設定]** を選択します。
     3. **"Microsoft Scripting Runtime"** および **"Microsoft Scripting Library"** オプションをチェックします。

4. **Excelバージョン**
   - このマクロは最新のExcel VBA環境で実行されるよう設計されています。

5. **OS**
   - 現在、WINDOWS専用となります。

