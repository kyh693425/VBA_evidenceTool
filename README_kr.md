# 📂 VBA Evidence Tool

## 📋 소개
**VBA Evidence Tool**은 파일 관리 및 이미지 삽입 기능을 포함한 고급 엑셀 도구입니다.  
특정 폴더의 파일과 하위 폴더를 탐색하고, 유효한 이미지 파일을 찾아 엑셀 시트에 적절한 크기로 삽입하거나 지정된 작업을 수행합니다.  
또한, 여러 시트를 병합 및 삭제하여 효율적인 데이터 관리를 돕습니다.

---

## 📦 주요 기능
1. **시트 삭제 (`DeleteSheet`)**
   - 기존 시트를 확인하고 특정 시트를 삭제한 후 초기화합니다.

2. **시트 내보내기 (`ExportWorkSheets`)**
   - 현재 엑셀 파일에서 특정 시트를 추출하여 새로운 파일로 저장합니다.
   - 기본 서식 및 설정을 적용해 저장된 파일을 관리합니다.

3. **폴더 및 파일 탐색 (`FList_MST`, `Folder_List`, `File_List`)**
   - 선택한 폴더 및 하위 폴더를 재귀적으로 탐색하여 파일 목록을 수집합니다.

4. **이미지 편집 및 삽입 (`EditPicture`)**
   - 유효한 이미지 파일(JPG, PNG 등)을 엑셀 시트에 삽입합니다.
   - 이미지 크기와 해상도에 따라 셀 범위를 동적으로 조정합니다.

5. **시트 중복 확인 (`SearchSameNameSheet`)**
   - 동일한 이름의 시트가 존재하는지 확인하고, 필요 시 새로운 시트를 생성하거나 기존 시트를 덮어씁니다.

6. **파일 탐색기 열기 (`OpenExplorer`)**
   - 작업이 완료된 폴더를 Windows 파일 탐색기에서 열어 작업 결과를 확인합니다.

7. **경고 메시지 표시 (`AlertMessage`)**
   - 유효하지 않은 파일 형식이나 기타 오류 상황에 대한 경고 메시지를 제공합니다.

---

## 🛠️ 사용 방법
1. **엑셀 매크로 설정**
   - 엑셀에서 VBA 편집기를 열고(`Alt + F11`), 코드 창에 제공된 VBA 코드를 붙여넣습니다.
   - "Microsoft Scripting Runtime" 라이브러리를 참조에 추가합니다.

2. **폴더 선택**
   - 매크로 실행 시 폴더 선택 창이 열립니다. 탐색할 폴더를 선택하세요.

3. **파일 및 이미지 작업**
   - 유효한 이미지 파일이 선택된 폴더에서 검색되어 지정된 규칙에 따라 엑셀 시트에 삽입됩니다.

4. **시트 작업**
   - 불필요한 시트를 삭제하거나, 특정 시트를 추출하여 새 파일로 저장할 수 있습니다.

---

## 📂 코드 설명
### 주요 함수 및 서브루틴
1. **`DeleteSheet()`**
   - "Tool" 시트를 제외한 모든 시트를 삭제합니다.
   - 삭제 전 사용자 확인 메시지가 표시됩니다.

2. **`ExportWorkSheets()`**
   - 현재 워크북의 특정 시트를 추출하여 별도의 파일로 저장합니다.
   - 저장된 파일은 자동으로 열립니다.

3. **`FList_MST()` 및 `Folder_List()`**
   - 폴더 및 하위 폴더를 재귀적으로 탐색하여 파일 목록을 수집합니다.

4. **`File_List()`**
   - 각 파일의 형식을 확인하고, 적합한 파일만 처리하도록 필터링합니다.

5. **`EditPicture()`**
   - 이미지 파일을 엑셀 시트에 삽입하고, 크기를 조정합니다.

6. **`SearchSameNameSheet()`**
   - 동일한 이름의 시트가 존재하는 경우 삭제 후 새 시트를 생성하거나 기존 시트를 유지합니다.

7. **`AlertMessage()`**
   - 유효하지 않은 파일이나 오류 상황에 대한 사용자 경고를 제공합니다.

---

## 📮 주의 사항
1. **폴더와 파일의 유효성 확인**
   - 올바른 이미지 파일 형식(JPG, PNG)만 삽입됩니다.
   - 숨김, 시스템 파일 등은 처리되지 않습니다.

2. **시트 작업**
   - 작업 전 중요한 데이터를 백업하세요. 시트 삭제 시 복구할 수 없습니다.

3. **엑셀 버전**
   - 이 매크로는 최신 엑셀 VBA 환경에서 실행되도록 설계되었습니다.

---

## 📜 라이선스
이 프로젝트는 [MIT 라이선스](./LICENSE)를 따릅니다. 자세한 내용은 LICENSE 파일을 확인하세요.

---

📌 **정확한 매크로 실행을 위해 제공된 절차를 따르고, 데이터 손실 방지를 위해 항상 백업을 권장합니다.**
